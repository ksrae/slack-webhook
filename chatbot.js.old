const { App } = require('@slack/bolt');

// 환경 변수에서 토큰 가져오기
const SLACK_BOT_TOKEN = 'xoxb-2793807820071-8276065119143-JPopN0Qb6K3rwNvWITGgphHS';
const SLACK_APP_TOKEN = 'xapp-1-A0897BRRV96-8276196146503-f9081cd8478838fd8d0ebd7dc35415cf1e031db65f0feecce080d62c8031e830';

// Bolt 앱 초기화
const app = new App({
  token: SLACK_BOT_TOKEN,
  appToken: SLACK_APP_TOKEN, // Socket Mode를 위해 필요
  socketMode: true,           // Socket Mode 활성화
});

// 이벤트 핸들러 등록: `app_mention` 이벤트가 발생할 때 실행
app.event('app_mention', async ({ event, say }) => {
  // console.log(event, event.text.replace(/<[^>]*>/g, '').trim()); // 이벤트 객체 출력
	const message = event?.text.replace(/<[^>]*>/g, '').trim();
	console.log(message);
  await say('Hi there!');
});

// 앱 실행
(async () => {
  try {
    await app.start();
    console.log('⚡️ Bolt app is running!');
  } catch (error) {
    console.error('Unable to start the app:', error);
  }
})();